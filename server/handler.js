'use strict';
const submitFile = require("./submitFile");
const submitUrl = require("./submitUrl");
const retrieveScan = require("./retrieveScan");

module.exports.submitFileScan = (event, context, callback) => {
    
    submitFile.start(JSON.parse(event.body), (data) => {
        console.log('DATA_SENT_BACK: ', data);
        const response = {
            isBase64Encoded: false,
            statusCode: 200,
            headers: { 
                'Access-Control-Allow-Origin': '*',
				'Access-Control-Allow-Credentials': true,
                'Content-Type': 'application/json'
            },
            body: data.toString()
        }
        callback(null, response);
    });
  
};

module.exports.submitUrlScan = (event, context, callback) => {
    
    submitUrl.start(JSON.parse(event.body), (data) => {
        console.log('DATA_SENT_BACK: ', data);
        const response = {
            isBase64Encoded: false,
            statusCode: 200,
            headers: { 
                'Access-Control-Allow-Origin': '*',
				'Access-Control-Allow-Credentials': true,
                'Content-Type': 'application/json'
            },
            body: data.toString()
        }
        callback(null, response);
    });
  
};

module.exports.retrieveScan = (event, context, callback) => {

    retrieveScan.start(JSON.parse(event.body), (data) => {
        console.log('DATA_SENT_BACK: ', data);
        const response = {
            isBase64Encoded: false,
            statusCode: 200,
            headers: { 
                'Access-Control-Allow-Origin': '*',
				'Access-Control-Allow-Credentials': true,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        }
        callback(null, response);
    });
  
};