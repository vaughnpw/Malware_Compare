import Layout from '../components/layout.js'
import {withRouter} from 'next/router'
import Markdown from 'react-markdown'
import { Component } from "react";
import reqwest from 'reqwest';
import fetch from 'isomorphic-unfetch'; 
import { Statistic, Row, Col, Button, Table } from 'antd';
import "../style.less";

const http = require('https');
const md5 = require('md5');

const columns = [
    {
        title: 'Name',
        dataIndex: 'name',
        sorter: true,
        render: name => `${name.first} ${name.last}`,
        width: '20%',
    }, 
    {
        title: 'Gender',
        dataIndex: 'gender',
        filters: [
        { text: 'Male', value: 'male' },
        { text: 'Female', value: 'female' },
        ],
        width: '20%',
    }, 
    {
        title: 'Email',
        dataIndex: 'email',
    }
];
  

class Compare extends Component {

    constructor(props) {
      super(props);
      this.state = {
        fileList: []
      };
    }

    state = {
        data: [],
        pagination: {},
        loading: false,
    };

    // static async getInitialProps(props) {
    //   console.log('props: ', props);
    //   const { query } = props;
    //   if (query.data) { 
    //     console.log('data received: ', query.data);
    //     const fileList = query.fileList;
    //     console.log('file list received: ', fileList);
    //     const apiKey = "48b2abe33cca0ec3dbc468d90f0c2c1cf2441eed15f8c5c4de223deda5b2d10a";

    //     const get
    //   }
    // }

    // componentDidMount() {
    //     // this.fetch();
    // }

    handleTableChange = (pagination, filters, sorter) => {
        const pager = { ...this.state.pagination };
        pager.current = pagination.current;
        this.setState({
          pagination: pager,
        });
        this.fetch({
          results: pagination.pageSize,
          page: pagination.current,
          sortField: sorter.field,
          sortOrder: sorter.order,
          ...filters,
        });
    }

    fetch = (params = {}) => {
      console.log('params:', params);
      this.setState({ loading: true });
      reqwest({
        url: 'https://randomuser.me/api',
        method: 'get',
        data: {
          results: 10,
          ...params,
        },
        type: 'json',
      }).then((data) => {
        const pagination = { ...this.state.pagination };
        // Read total count from server
        // pagination.total = data.totalCount;
        pagination.total = 200;
        this.setState({
          loading: false,
          data: data.results,
          pagination,
        });
      });
    }

    render() {
        return(
            <Layout>
                <div className="compare_page_text">
                    <h2>Compared Results</h2>
                    <p>Based on your uploads here are the our comparisons.</p>
                </div>
                <div className="top_tier_compare_data">
                  <Row gutter={16}>
                    <Col span={12}>
                      <Statistic title="Active Users" value={112893} />
                    </Col>
                    <Col span={12}>
                      <Statistic title="Account Balance (CNY)" value={112893} precision={2} />
                      <Button style={{ marginTop: 16 }} type="primary">Recharge</Button>
                    </Col>
                  </Row>
                </div>
                <div className="compare_data_table"> 
                <Table
                  columns={columns}
                  rowKey={record => record.login.uuid}
                  dataSource={this.state.data}
                  pagination={this.state.pagination}
                  loading={this.state.loading}
                  onChange={this.handleTableChange}
                />
                </div>
                <style jsx>{`
                    .top_tier_compare_data {
                        padding: 24px;
                    }
                    .compare_data_table {
                        
                    }
                `}</style>
            </Layout>
        );
    }

}

export default Compare